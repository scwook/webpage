<!DOCTYPE html>
<html>
<style>
	table {
		font-family: arial, sans-serif;
		border-collapse: collapse;
		width: 100%;
	}

	td, th {
		border: 1px solid #cccccc;
		padding: 8px;
	}

	th {
		font-weight: bold;
		text-transform: uppercase;
	}

	tr:nth-child(even) {
		background-color: #dddddd;
	}

	tr:hover {
		background-color: black;
		color: white;
	}

</style>
<body>
	<input id="gsearch" value="pv name">
	<button type="button" id="myBtn" onclick="loadSearch()">search</button>


	<table>
		<thead>
			<tr>
				<th>Name</th>
				<th>Age</th>
			</tr>
		</thead>

		<tbody id="tableData"></tbody>
	</table>

	<div id="demo"></div>
</body>

<script>
	function loadSearch() {
		var searchText = document.getElementById("gsearch").value;
		loadDoc(searchText);
	}

	var input = document.getElementById("gsearch");
		input.addEventListener("keyup", function(event) {
			if (event.keyCode === 13) {
			event.preventDefault();
			document.getElementById("myBtn").click();
		}
	});


	let sortDirection = false;
	let personData = [
		{name: 'Dylan', age: 31},
		{name: 'Christopher', age: 30},
		{name: 'Israel', age: 29},
		{name: 'ThugNasty', age: 14},
		{name: 'scwook', age: 31},
	];

	window.onload = () => {
		loadTableData(personData);
		//loadDoc();
	}

	loadTableData(personData);

	function loadTableData(tableData) {
		const tableBody = document.getElementById('tableData');
		let dataHtml = '';

		for(let person of personData) {
			dataHtml += `<tr><td>${person.name}</td><td>${person.age}</td></tr>`;
		}

		console.log(dataHtml)
		tableBody.innerHTML = dataHtml;
	}



	function loadDoc(retrievalName) {
		var xhttp = new XMLHttpRequest();
		xhttp.onreadystatechange = function() {
			if (this.readyState == 4 && this.status == 200) {
				var jsonValue = JSON.parse(this.responseText);
				
				var pvData = '';
				for(var i = 0; i < jsonValue.length; i++) {
					//document.getElementById("demo").innerHTML = jsonValue.length;
					console.log(jsonValue[i].pvName);
					pvData += `<tr><td>${jsonValue[i].pvName}</td><td>${jsonValue[i].connectionState}</td></tr>`

				}

			}

			document.getElementById("tableData").innerHTML = pvData;
		};
		var rName = "http://localhost:17665/mgmt/bpl/getPVStatus?pv=" + retrievalName;
		console.log(rName);
		xhttp.open("GET", rName, true);
		xhttp.send();
	}

/*
		// Create the XHR object.
	function createCORSRequest(method, url) {
		var xhr = new XMLHttpRequest();
		if ("withCredentials" in xhr) {
			// XHR for Chrome/Firefox/Opera/Safari.
			xhr.open(method, url, true);
		} else if (typeof XDomainRequest != "undefined") {
			// XDomainRequest for IE.
			xhr = new XDomainRequest();
			xhr.open(method, url);
		} else {
			// CORS not supported.
			xhr = null;
		}
		return xhr;
	}

		// Helper method to parse the title tag from the response.
	function getTitle(text) {
		return text.match('<title>(.*)?</title>')[1];
	}

		// Make the actual CORS request.
	function makeCorsRequest() {
		// This is a sample server that supports CORS.
		var url = 'http://localhost:17665/mgmt/bpl/getPVStatus?pv=*';

		var xhr = createCORSRequest('GET', url);
		if (!xhr) {
			alert('CORS not supported');
			return;
		}

		// Response handlers.
		xhr.onload = function() {
			var text = xhr.responseText;
			var title = getTitle(text);
			alert('Response from CORS request to ' + url + ': ' + title);
		};

		xhr.onerror = function() {
				alert('Woops, there was an error making the request.');
		};

		xhr.send();
	}
*/



</script>


</html>